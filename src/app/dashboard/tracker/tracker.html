<main class="container">
  <!-- Header Section -->
  <div class="main-header">
    <div class="main-title">
      <h1>Child Tracker</h1>
      <p>Monitor your child's development, growth, and health milestones</p>
    </div>
    
    <div class="child-select">
      <label for="childDropdown">Select Child</label>
      <select
        id="childDropdown"
        [(ngModel)]="selectedChild"
        (ngModelChange)="onChildChange($event)"
        class="select-trigger"
      >
        <option *ngFor="let child of children" [value]="child.id">
          {{ child.name }} ({{ getAge(child.dateOfBirth) }} years)
        </option>
      </select>
    </div>
  </div>

  <!-- Tabs Section -->
  <div class="tabs">
    <!-- Tab Navigation -->
    <div class="tabs-list">
      <button
        class="tab-trigger"
        [class.active]="activeTab === 'milestones'"
        (click)="setActiveTab('milestones')"
      >
        Milestones
      </button>
      <button
        class="tab-trigger"
        [class.active]="activeTab === 'vaccines'"
        (click)="setActiveTab('vaccines')"
      >
        Vaccines
      </button>
      <button
        class="tab-trigger"
        [class.active]="activeTab === 'growth'"
        (click)="setActiveTab('growth')"
      >
        Growth
      </button>
    </div>

    <!-- Milestones Tab Content -->
    <div class="tab-content" [class.active]="activeTab === 'milestones'">
      <div class="card">
        <div class="card-header">
          <div>
            <h2 class="card-title">
              <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              Developmental Milestones
            </h2>
            <p class="card-description">Track your child's developmental progress</p>
          </div>
          <button class="btn btn-primary" (click)="openAddMilestoneForm()">
            <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path>
            </svg>
            Add Milestone
          </button>
        </div>
        <div class="card-content">
          <div class="item-list">
            <div class="item" *ngFor="let m of milestones">
              <div class="item-left">
                <div 
                  class="status-dot"
                  [ngClass]="{
                    'status-completed': m.status === 'COMPLETED',
                    'status-pending': m.status === 'PENDING'
                  }"
                ></div>
                <div class="item-info">
                  <h3>{{ m.title }}</h3>
                  <p>{{ m.milestoneType }} ‚Ä¢ {{ m.description }}</p>
                </div>
              </div>
              <div class="item-right">
                <span 
                  class="badge"
                  [ngClass]="{
                    'badge-completed': m.status === 'COMPLETED',
                    'badge-upcoming': m.status === 'PENDING'
                  }"
                >
                  {{ m.status }}
                </span>
                      <div>
          <button class="btn btn-outline btn-sm" (click)="completeMilestone(m)" [hidden]="m.status === 'COMPLETED'">Mark Completed</button>
           <button 
                  class="btn btn-outline btn-sm" 
                  style="color: #dc2626;"
                  (click)="deleteMilestone(m.id!)"
                >
                  üóëÔ∏è
                </button>
        </div>
              </div>
            </div>
            <p *ngIf="growthRecords.length === 0" style="text-align: center; color: #64748b; padding: 2rem;">
              No milestones recorded yet. Click "Add Milestone" to get started.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Vaccines Tab Content -->
    <div class="tab-content" [class.active]="activeTab === 'vaccines'">
      <div class="card">
        <div class="card-header">
          <div>
            <h2 class="card-title">
              <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
              </svg>
              Vaccination Records
            </h2>
            <p class="card-description">Keep track of vaccines and upcoming immunizations</p>
          </div>
          <button class="btn btn-primary" (click)="openAddVaccineForm()">
            <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path>
            </svg>
            Record Vaccine
          </button>
        </div>
        <div class="card-content">
          <!-- Vaccine List -->
          <div class="item-list">
            <div class="item" *ngFor="let vaccine of vaccines">
              <div class="item-left">
                <div 
                  class="status-dot"
                  [ngClass]="{
                    'status-completed': vaccine.status === 'completed',
                    'status-due': vaccine.status === 'due'
                  }"
                ></div>
                <div class="item-info">
                  <h3>{{ vaccine.name }}</h3>
                  <p *ngIf="vaccine.status === 'completed'">Given: {{ vaccine.date }}</p>
                  <p *ngIf="vaccine.status === 'due'">Due: {{ vaccine.date }}</p>
                </div>
              </div>
              <div class="item-right">
                <span 
                  class="badge"
                  [ngClass]="{
                    'badge-completed': vaccine.status === 'completed',
                    'badge-due': vaccine.status === 'due'
                  }"
                >
                  {{ vaccine.status === 'completed' ? 'Completed' : 'Due Soon' }}
                </span>
                <button class="btn btn-outline btn-sm" (click)="editVaccine(vaccine)">
                  ‚úèÔ∏è
                </button>
                <button 
                  class="btn btn-outline btn-sm" 
                  style="color: #dc2626;"
                  (click)="deleteVaccine(vaccine.id)"
                >
                  üóëÔ∏è
                </button>
              </div>
            </div>
            <p *ngIf="vaccines.length === 0" style="text-align: center; color: #64748b; padding: 2rem;">
              No vaccines recorded yet. Click "Record Vaccine" to get started.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Growth Tab Content -->
    <div class="tab-content" [class.active]="activeTab === 'growth'">
      <div class="card">
        <div class="card-header">
          <div>
            <h2 class="card-title">
              <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
              </svg>
              Growth Records
            </h2>
            <p class="card-description">Monitor your child's physical development</p>
          </div>
          <button class="btn btn-primary" (click)="openAddMilestoneForm()">
            <svg class="icon-sm" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path>
            </svg>
            Update Measurement
          </button>
        </div>
        <div class="card-content">
          <!-- Growth Cards Grid -->
          <div class="growth-grid">
            <!-- Height Card -->
            <div class="card growth-card">
              <div class="card-header">
                <h3 class="card-title">
                  <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M7 21L3 9l4-8 4 8-4 12zM21 9l-4 8-4-8 4-8 4 8z"></path>
                  </svg>
                  Height
                </h3>
              </div>
              <div class="card-content">
                <div class="growth-value">{{ latestHeight || '--' }} cm</div>
                <div class="percentile">
                  {{ heightPercentile ? heightPercentile + 'th percentile' : 'No data' }}
                </div>
                <div class="last-updated">
                  Last updated: {{ lastUpdatedHeight || 'Never' }}
                </div>
                <div class="progress">
                  <div class="progress-bar" [style.width.%]="heightPercentile || 0"></div>
                </div>
              </div>
            </div>

            <!-- Weight Card -->
            <div class="card growth-card">
              <div class="card-header">
                <h3 class="card-title">
                  <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"></path>
                  </svg>
                  Weight
                </h3>
              </div>
              <div class="card-content">
                <div class="growth-value">{{ latestWeight || '--' }} kg</div>
                <div class="percentile">
                  {{ weightPercentile ? weightPercentile + 'th percentile' : 'No data' }}
                </div>
                <div class="last-updated">
                  Last updated: {{ lastUpdatedWeight || 'Never' }}
                </div>
                <div class="progress">
                  <div class="progress-bar" [style.width.%]="weightPercentile || 0"></div>
                </div>
              </div>
            </div>

            <!-- Head Circumference Card -->
            <div class="card growth-card">
              <div class="card-header">
                <h3 class="card-title">
                  <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                  </svg>
                  Head Circumference
                </h3>
              </div>
              <div class="card-content">
                <div class="growth-value">47 cm</div>
                <div class="percentile">80th percentile</div>
                <div class="last-updated">Last updated: 2024-01-10</div>
                <div class="progress">
                  <div class="progress-bar" style="width: 80%"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Milestone Modal -->
  <div class="modal-overlay" *ngIf="showAddMilestoneForm">
    <div class="modal-card">
      <h2>Add New Milestone</h2>
      
      <form (ngSubmit)="submitMilestone()">
        <div class="form-group">
          <label>Title</label>
          <input
            type="text"
            [(ngModel)]="newMilestone.title"
            name="title"
            placeholder="e.g., First steps, said first word"
            required
          />
        </div>

        <div class="form-group">
          <label>Description</label>
          <input
            type="text"
            [(ngModel)]="newMilestone.description"
            name="description"
            required
          />
        </div>
        <div class="form-group">
          <label>Expected Age</label>
          <input
            type="number"
            [(ngModel)]="newMilestone.expectedAgeMonths"
            name="expectedAgeMonths"
            required
          />
        </div>

        <div class="form-group">
          <label>Type</label>
          <select [(ngModel)]="newMilestone.milestoneType" name="milestoneType" required>
             <option value="PHYSICAL">Physical</option>
            <option value="COGNITIVE">Cognitive</option>
            <option value="SOCIAL">Social</option>
            <option value="EMOTIONAL">Emotional</option>
            <option value="LANGUAGE">Language</option>
          </select>
        </div>

        <div class="form-group">
          <label>Status</label>
          <select [(ngModel)]="newMilestone.status" name="status" required>
             <option value="PENDING">Pending</option>
            <option value="COMPLETED">Completed</option>
            <option value="OVERDUE">Overdue</option>
          </select>
        </div>

        <!-- <div class="form-group">

          <label>Height (cm)</label>
          <input 
            type="number" 
            [(ngModel)]="newMilestone.height" 
            name="height"
            placeholder="Optional"
          />
        </div> -->
          <!-- <label>Type</label>
      <select [(ngModel)]="newMilestone.milestoneType" name="milestoneType">
        <option value="PHYSICAL">Physical</option>
        <option value="COGNITIVE">Cognitive</option>
        <option value="SOCIAL">Social</option>
        <option value="EMOTIONAL">Emotional</option>
        <option value="LANGUAGE">Language</option>
      </select> -->

        <!-- <div class="form-group">
          <label>Weight (kg)</label>
          <input 
            type="number" 
            [(ngModel)]="newMilestone.weight" 
            name="weight"
            placeholder="Optional"
          />
        </div> -->
           <!-- <label>Status</label>
      <select [(ngModel)]="newMilestone.status" name="status">
        <option value="PENDING">Pending</option>
        <option value="COMPLETED">Completed</option>
        <option value="OVERDUE">Overdue</option>
      </select> -->

        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Save</button>
          <button type="button" class="btn btn-secondary" (click)="closeAddMilestoneForm()">
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add/Edit Vaccine Modal -->
  <div class="modal-overlay" *ngIf="showAddVaccineForm">
    <div class="modal-card">
      <h2>{{ editingVaccine ? 'Update Vaccine' : 'Record Vaccine' }}</h2>
      
      <form (ngSubmit)="recordVaccine()">
        <div class="form-group">
          <label>Vaccine Name</label>
          <input
            type="text"
            [(ngModel)]="newVaccine.name"
            name="vaccineName"
            placeholder="e.g., MMR, DTaP, Polio"
            required
          />
        </div>

        <div class="form-group">
          <label>Status</label>
          <select [(ngModel)]="newVaccine.status" name="vaccineStatus" required>
            <option value="completed">Completed</option>
            <option value="due">Due</option>
          </select>
        </div>

        <div class="form-group">
          <label>Date</label>
          <input 
            type="date" 
            [(ngModel)]="newVaccine.date" 
            name="vaccineDate" 
            required 
          />
        </div>

        <div class="form-actions">
          <button type="submit" class="btn btn-primary">
            {{ editingVaccine ? 'Update' : 'Save' }}
          </button>
          <button type="button" class="btn btn-secondary" (click)="closeAddVaccineForm()">
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>
</main>